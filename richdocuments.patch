From c567e500e91857728dcd82a0540c2d16c02b5a45 Mon Sep 17 00:00:00 2001
From: Mikael Nordin <mickenordin@users.noreply.github.com>
Date: Mon, 11 Apr 2022 14:23:34 +0200
Subject: [PATCH] Add gs.trustedHosts to form-action csp

This will allow loadbalanced collabora servers to serv frames

Signed-off-by: Micke Nordin <kano@sunet.se>
---
 lib/AppInfo/Application.php | 1 +
 1 file changed, 1 insertion(+)

diff --git a/lib/AppInfo/Application.php b/lib/AppInfo/Application.php
index 3d6403407..8163d6ad2 100644
--- a/lib/AppInfo/Application.php
+++ b/lib/AppInfo/Application.php
@@ -229,6 +229,7 @@ public function updateCSP() {
 				foreach ($trustedList as $server) {
 					$policy->addAllowedFrameDomain($server);
 					$this->addTrustedRemote($policy, $server);
+					$policy->addAllowedFormActionDomain($server);
 				}
 			}
 			$remoteAccess = $container->getServer()->getRequest()->getParam('richdocuments_remote_access');
